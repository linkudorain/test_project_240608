## 8 3次元ソリッド要素

### 3次元構造物のモデル化:
- 4.1節で述べた梁状構造や薄肉構造などの単純な形状は、はりやシェルとして幾何学的に表現可能
- 複雑な3次元構造物に対しては、4章から6章で述べたはり要素やシェル要素を適用して適切にモデル化する

### ソリッド要素の適用:
- 3次元の連続した物体形状を有し、応力状態も3次元の複雑な分布を示す構造物には、3次元の連続体力学にもとづくソリッド要素（連続体要素）を用いる

### 実際の問題での考慮事項:
- 構造全体あるいはその部分において、曲げなどの変形モードが卓越する状況もしばしば現れる
- 3次元ソリッド要素においても、2, 3章で議論した、曲げなどに対する要素の性能を考慮する必要がある

### 本章の内容:
- 3次元ソリッド要素の例と、その要素の性能について述べる

## 8.1 3次元ソリッド要素の定式化

### 基本的な定式化:
- 3次元問題においても、1.1節で述べた次の仮想仕事の原理にもとづく定式化から始める:

  $a(\mathbf{u},\mathbf{v}) = L(\mathbf{v})$

  ここで、$\mathbf{u}, \mathbf{v}$ はそれぞれ変位場、仮想変位場である

### 内力仕事と外力仕事:
- 内力仕事に対する双1次形式 $a(\mathbf{u},\mathbf{v})$ と、外力仕事に対する線形汎関数 $L(\mathbf{v})$ は以下のように表される:

  $a(\mathbf{u},\mathbf{v}) = \int_\Omega \boldsymbol{\varepsilon}(\mathbf{v}) : (\mathbf{C} : \boldsymbol{\varepsilon}(\mathbf{u}))dV$

  $L(\mathbf{v}) = \int_\Omega \mathbf{v} \cdot \mathbf{f} dV + \int_{\Gamma_t} \mathbf{v} \cdot \mathbf{t} dS$

### ひずみと応力:
- ひずみと応力には、それぞれ6個の成分すべてを用いることとなる

### 仮想仕事の原理に対する定式化:
- 有限要素近似を用いたガラーキン法を適用する

### 要素内での変位 $\mathbf{u}$ の補間:
- $\mathbf{u} = \sum_{a=1}^m N_a \mathbf{u}_a$
- ここで、$N_a$ は補間関数、$\mathbf{u}_a$ は、節点 $a$ における次の節点変位ベクトルである:

  $\mathbf{u}_a = \begin{Bmatrix} u_1 \\ u_2 \\ u_3 \end{Bmatrix}_a$

### 3次元のひずみ6成分を与える変位-ひずみ関係式:
- $\boldsymbol{\varepsilon} = \sum_{a=1}^m \mathbf{B}_a \mathbf{u}_a$
- $\mathbf{B}_a$ は以下の式で表される:

  $\mathbf{B}_a = \begin{bmatrix} 
  \frac{\partial N_a}{\partial x_1} & 0 & 0 \\
  0 & \frac{\partial N_a}{\partial x_2} & 0 \\
  0 & 0 & \frac{\partial N_a}{\partial x_3} \\
  \frac{\partial N_a}{\partial x_2} & \frac{\partial N_a}{\partial x_1} & 0 \\
  0 & \frac{\partial N_a}{\partial x_3} & \frac{\partial N_a}{\partial x_2} \\
  \frac{\partial N_a}{\partial x_3} & 0 & \frac{\partial N_a}{\partial x_1}
  \end{bmatrix}$

### 等方弾性体を仮定した場合の応力-ひずみ関係マトリックス:
- 式(1.8)より以下のように表される:

  $\mathbf{D} = \frac{E(1-\nu)}{(1+\nu)(1-2\nu)} \begin{bmatrix}
  1 & \frac{\nu}{1-\nu} & \frac{\nu}{1-\nu} & 0 & 0 & 0 \\
  \frac{\nu}{1-\nu} & 1 & \frac{\nu}{1-\nu} & 0 & 0 & 0 \\
  \frac{\nu}{1-\nu} & \frac{\nu}{1-\nu} & 1 & 0 & 0 & 0 \\
  0 & 0 & 0 & \frac{1-2\nu}{2(1-\nu)} & 0 & 0 \\
  0 & 0 & 0 & 0 & \frac{1-2\nu}{2(1-\nu)} & 0 \\
  0 & 0 & 0 & 0 & 0 & \frac{1-2\nu}{2(1-\nu)}
  \end{bmatrix}$



### 要素剛性マトリックス:
- したがって、要素剛性マトリックス $\mathbf{k}^e_{ab}$ は、式(8.5)のように表される:

  $\mathbf{k}^e_{ab} = \int_{\Omega_e} \mathbf{B}_a^T \mathbf{D} \mathbf{B}_b dx dy dz$

## 8.2 3次元ソリッド要素における補間関数

### 8.2.1 四面体要素

2次元における単体（基本図形）は三角形であり、3次元では四面体となる。そこで、2次元における三角形要素に対応する3次元の要素として、3次元では、要素形状を四面体として補間関数を構成した四面体要素が用いられる。特に、幾何学的な要素分割は、数学的な要素分割可能性の観点と、実際の分割アルゴリズムにおいて適したものとなる3次元問題において、四面体要素はもっとも利用頻度が高い要素となっている。

四面体要素の補間関数を考えるにあたり、アイソパラメトリック要素を想定し、補間関数を局所座標系 $(r,s,t)$ で定義するものとする。図8.1(a)に示すもっとも単純な四面体1次要素の補間関数は、次式で定義される:

$N_1(r,s,t) = 1 - r - s - t$
$N_2(r,s,t) = r$
$N_3(r,s,t) = s$
$N_4(r,s,t) = t$

式(8.6)では、要素内のひずみと応力は定数となる。したがって、応力が材料直角方向に線形分布するような問題などにおいては、1.4.2項で考えた2次元の三角形1次要素と同様に、粗い要素分割において精度の低い結果しか得られず、四面体1次要素は性能の低い要素となる。

このような観点から、近年、多く用いられる四面体要素は、要素内で完全2次式となる、10節点の四面体2次要素となっている。図8.1(b)に示す節点配置を表現可能な、10節点の四面体2次要素の補間関数は、次式で定義される:

$N_1(r,s,t) = 2(1-r-s-t)(1/2-r-s-t)$
$N_2(r,s,t) = 2r(r-1/2)$
$N_3(r,s,t) = 2s(s-1/2)$
$N_4(r,s,t) = 2t(t-1/2)$
$N_5(r,s,t) = 4r(1-r-s-t)$
$N_6(r,s,t) = 4rs$
$N_7(r,s,t) = 4s(1-r-s-t)$
$N_8(r,s,t) = 4t(1-r-s-t)$
$N_9(r,s,t) = 4rt$
$N_{10}(r,s,t) = 4st$

### 8.2.2 六面体要素

2次元における四辺形に対応する3次元の要素は、六面体要素となる。このとき
の補間関数は、2.1.2項で示した2次元の場合と同様に、基本的に1次元のラグランジュ補間関数のテンソル積として構成される。

1次補間を基本とした六面体三重1次要素の補間関数は、局所座標系 $(\xi,\eta,\zeta)$ によって、以下のように表すことができる:

$N_1(\xi,\eta,\zeta) = \frac{1}{8}(1-\xi)(1-\eta)(1-\zeta)$
$N_2(\xi,\eta,\zeta) = \frac{1}{8}(1+\xi)(1-\eta)(1-\zeta)$
$N_3(\xi,\eta,\zeta) = \frac{1}{8}(1+\xi)(1+\eta)(1-\zeta)$
$N_4(\xi,\eta,\zeta) = \frac{1}{8}(1-\xi)(1+\eta)(1-\zeta)$
$N_5(\xi,\eta,\zeta) = \frac{1}{8}(1-\xi)(1-\eta)(1+\zeta)$
$N_6(\xi,\eta,\zeta) = \frac{1}{8}(1+\xi)(1-\eta)(1+\zeta)$
$N_7(\xi,\eta,\zeta) = \frac{1}{8}(1+\xi)(1+\eta)(1+\zeta)$
$N_8(\xi,\eta,\zeta) = \frac{1}{8}(1-\xi)(1+\eta)(1+\zeta)$

このときの節点配置は図8.2のようになる。

六面体三重1次要素は、基本的に2次元における四辺形1次要素と同様な性質をもつ。したがって、曲げが卓越する問題などにおいて、ロッキング現象が現れる。

このことから、3章で述べたEAS要素などの要素改良技術が、六面体三重1次要素に適用されることがある。

### 8.2.3 その他の要素

3次元問題における、要素分割の複雑さを緩和するものとして、平面内の三角形1次要素に対して、高さ方向に1次補間を用いて形状関数を構成した、6節点五面体プリズム要素などが用いられることもある。

1次要素に対して、高さ方向に1次補間を用いて形状関数を構成した、6節点点五面体プリズム要素を考える。このときの補間関数は

$1-r-s, r, s$

となり、t方向の1次補間は

$\frac{1-t}{2}, \frac{1+t}{2}$

と表されることから、これらのテンソル積として次のような補間関数が得られる。

$N_1(r,s,t) = \frac{1}{2}(1-r-s)(1-t)$
$N_2(r,s,t) = \frac{1}{2}r(1-t)$
$N_3(r,s,t) = \frac{1}{2}s(1-t)$
$N_4(r,s,t) = \frac{1}{2}(1-r-s)(1+t)$
$N_5(r,s,t) = \frac{1}{2}r(1+t)$
$N_6(r,s,t) = \frac{1}{2}s(1+t)$

節点配置は図8.4のようになる。さらに高次のラグランジュ族の六面体要素や、セレンディピティ族の六面体要素についても、2次元の場合と同様に導出することができる。

## 8.3 3次元ソリッド要素の性能

3章で述べた2次元における四辺形要素の場合と同様に、曲げのような力学的挙動を粗いメッシュで高精度に計算するためには、3次元の場合、高性能な六面体要素を用いた一様メッシュに近い要素分割を行うことが望ましい。しかしながら、六面体要素の有する性能を生かした要素分割を、複雑な形状に対して行うことは困難であると考えられる。

一方、四面体要素を用いれば、基本的にどんな複雑な形状に対しても自動要素分割が可能である。

本節では、このような現状を踏まえて、3次元ソリッド要素の性能について概観することを試みる。

ここでは、曲げやねじりなどの変形モードが卓越する構造の問題として、片持ちはりの曲げ、丸棒のねじり、厚肉円筒の曲げという、3つの問題をベンチマーク問題として取り上げる。これらの問題に対して、粗い要素分割と比較的細かい要素分割の2種類を用い、数値実験により性能を評価する。

ここで考えている単純な解析領域に対しては、一様な規則格子を容易に生成できるが、四面体要素において、"自動要素分割を行った場合の性能に注目すべき"と考え、自動要素分割による要素分割を用いる。具体的な要素分割には、アドバンシングフロント法にもとづく分割をGiDにより行っている。また、ポアソン比を0.3としている。

### 8.3.1 片持ちはりの曲げ問題

2次元問題と同様に、図8.5の片持ちはりの先端に荷重が作用する問題を考える。境界条件としては、はりの固定端となる面の節点はすべて拘束し、他端の面に等分布荷重により、せん断力を作用させる。用いた要素分割を図8.6に示す。それぞれの結果については、得られた先端のたわみについて、1.4.2項で示したせん断変形を考慮したはりの理論解（1.104）により正規化を行う。その上で、正規化変位として比較をする。

この問題に対する四面体要素による計算結果を表8.1に示す。この結果から、四面体1次要素は2次元の三角形1次要素と同様に性能が低く、過剰に曲げモードを表すにはかなり細かい要素分割が必要となることがわかる。これに対して、曲げモードにおけるひずみの線形変化を表現可能な、四面体2次要素では、粗い要素分割でも精度よく計算できている。

また、六面体要素による計算結果を表8.2に示す。2次元における四辺形1次要素の場合と同様に、変位法にもとづく通常要素の性能は低いが、EAS要素では粗い要素分割においてさえ精度の高い解を与えている。

以上、この問題について、四面体要素と六面体要素の結果を比較すると、四面体2次要素と六面体1次EAS要素により、精度の良い近似解が得られることがわかる。

## 8.3.2 丸棒のねじり問題

ねじりは2次元では現れないが、3次元ではしばしば重要となる変形モードである。ここでは、もっとも単純な図8.7のような丸棒のねじり問題を考える。

境界条件は、棒の一端となる面の節点はすべて固定し、他端の面に強制変形によりねじりが作用するものとしている。用いた要素分割を図8.8に示す。また、それぞれの結果については、サンブナンねじり（Saint-Venant's torsion）の理論解を用い、正規化を行っている。

### 四面体要素の性能
四面体要素による計算結果を表8.3に示す。四面体2次要素では粗い要素分割でも精度よく計算できており、四面体2次要素は、ねじり問題においてきわめて高い性能を有することがわかる。

### 六面体要素の性能
六面体要素による計算結果を表8.4に示す。曲げ変形が卓越する問題とは異なり、EAS要素の改良はねじりに対して効果が少なく、その性能は通常要素とほぼ同等であることがわかる。

## 8.3.3 厚肉円筒の曲げ問題

図8.9に示す、等分布荷重を受ける、厚肉円筒の曲げ問題を考える。境界条件としては、円周面の境界の節点はすべて固定し、上面に、等分布荷重を作用させるものとしている。また、解析領域は、対称性を利用し、1/4部分としている。

用いた要素分割を図8.10に示す。それぞれの計算結果については、面外せん断変形を考慮した解析解（5.41）により正規化を行う。その上で、中央のたわみについて比較をする。

### 四面体要素の性能
この問題に対する四面体要素による計算結果を表8.5に示す。はりの曲げの問題と同様に、板曲げの問題に対しても四面体1次要素は性能が低く、一方で、四面体2次要素では、粗い要素分割でも精度よく計算できている。

### 六面体要素の性能
六面体要素による計算結果を表8.6に示す。EAS要素の改良は板曲げ問題でも効果があり、通常要素と比べ、粗い要素分割でも精度の高い解を与えている。

これらの結果から、3次元ソリッド要素を用いた解析において、四面体2次要素と六面体EAS要素が高い性能を示すことが確認できる。特に四面体2次要素は、複雑な形状に対しても自動要素分割が可能であり、高精度な解析を行うための有力な選択肢となる。